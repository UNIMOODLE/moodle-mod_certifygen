define("mod_certifygen/modelcreate",["exports","jquery","core/str","core/ajax","core/templates","core/notification","core_form/modalform"],(function(_exports,_jquery,_str,_ajax,_templates,_notification,_modalform){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates),_notification=_interopRequireDefault(_notification),_modalform=_interopRequireDefault(_modalform);let SERVICES_GET_LIST_TABLE="mod_certifygen_getmodellisttable",ACTION_CREATE_MODEL='[data-action="create-model"]',REGION_LIST_TABLE='[data-region="model-list-table"]',TEMPLATES_LOADING="core/overlay_loading",TEMPLATES_MODELLISTTABLE="mod_certifygen/model_list_table";const checkTemplateidValue=()=>{let typeElement=document.querySelector('form [name="type"]');typeElement&&2==typeElement.value&&addTemplateidValue()},removeTemplateidVlaue=()=>{(0,_jquery.default)('form [name="templateid"]').each((function(){"hidden"==this.type&&(0,_jquery.default)(this).remove()}))},addTemplateidValue=()=>{const element=document.querySelector('form [name="templateid"]');element&&element.setAttribute("data-initial-value","0"),addHiddenTemplateidInput()},addHiddenTemplateidInput=()=>{(0,_jquery.default)("<input>").attr({name:"templateid",type:"hidden",value:0}).appendTo("form")},CreateModel=e=>{e.preventDefault();const element=e.target;let id=0;"edit-model"===event.currentTarget.getAttribute("data-action")&&(id=event.currentTarget.getAttribute("data-id"));const modalForm=new _modalform.default({formClass:"mod_certifygen\\forms\\modelform",args:{id:id},modalConfig:{title:(0,_str.get_string)("create_model","mod_certifygen")},returnFocus:element});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>{reloadModelListTable()})),modalForm.show()},reloadModelListTable=()=>{_templates.default.render(TEMPLATES_LOADING,{visible:!0}).done((function(html){let identifier=(0,_jquery.default)(REGION_LIST_TABLE);identifier.append(html);let request={methodname:SERVICES_GET_LIST_TABLE,args:{}};_ajax.default.call([request])[0].done((function(data){_templates.default.render(TEMPLATES_MODELLISTTABLE,data).then(((html,js)=>{identifier.html(html),_templates.default.runTemplateJS(js)})).fail(_notification.default.exception)})).fail(_notification.default.exception)}))};_exports.init=()=>{(0,_jquery.default)(ACTION_CREATE_MODEL).on("click",CreateModel),(0,_jquery.default)("body").on("change",".custom-select",(function(event){event.target&&"type"===event.target.name&&"2"==event.target.value?addTemplateidValue():event.target&&"type"===event.target.name&&"1"==event.target.value&&(0,_jquery.default)('form [name="templateid"]').length>1?removeTemplateidVlaue():checkTemplateidValue()})),(0,_jquery.default)("body").on("focusout",'input[type="text"]',(function(){checkTemplateidValue()}))}}));

//# sourceMappingURL=modelcreate.min.js.map